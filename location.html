<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>經緯度感測器</title>
  <style>
    body { font-family:sans-serif; padding:20px; }
    .item { margin-bottom:10px; }
    .label { font-size:13px; color:#666; }
    .value { font-size:20px; font-weight:600; }
    button { padding:10px 14px; font-size:16px; border:0; border-radius:8px; background:#1976d2; color:white; cursor:pointer; }
  </style>
</head>
<body>

<h2>經緯度感測器</h2>

<div class="item">
  <div class="label">緯度</div>
  <div class="value" id="lat">—</div>
</div>

<div class="item">
  <div class="label">經度</div>
  <div class="value" id="lon">—</div>
</div>

<button id="startBtn">開始取得位置</button>
<p id="msg" style="color:#c62828;"></p>

<script>
async function checkGeoPermission() {
  if (!navigator.permissions) return "unknown";
  try {
    const s = await navigator.permissions.query({ name:"geolocation" });
    return s.state;
  } catch(e) {
    return "unknown";
  }
}

document.getElementById("startBtn").addEventListener("click", async () => {
  const msg = document.getElementById("msg");
  const perm = await checkGeoPermission();

  if (perm === "denied") {
    msg.textContent = "權限被拒絕，請到瀏覽器設定允許位置。";
    return;
  }

  navigator.geolocation.watchPosition(
    (pos) => {
      const c = pos.coords;
      document.getElementById("lat").textContent = c.latitude;
      document.getElementById("lon").textContent = c.longitude;
      msg.textContent = "";
    },
    (err) => msg.textContent = err.message,
    { enableHighAccuracy:true }
  );
});
</script>

</body>
</html>
